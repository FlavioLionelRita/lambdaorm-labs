# LambdaORM service pentest

## Install

```sh
docker-compose -p "lambdaorm-svc-pentest" up -d
```

On docker service:

```sh
docker exec -it lambdaorm-svc-pentest-api /bin/bash
# install lambdaorm cli
npm install lambdaorm-cli -g
# verify cli
lambdaorm --version
# go to workspaces 
cd /workspaces
lambdaorm sync
```

On host:

```sh
# install lambdaorm cli
npm install lambdaorm-cli -g
# verify cli
lambdaorm --version
# go to workspace
cd ./volume/workspace
# create tables
lambdaorm sync 
# import data
lambdaorm import -e ".env" -d ./data.json
# verify
lambdaorm execute -e ".env" -q "Products.having(p => max(p.price) > 100).map(p => ({ category: p.category.name, largestPrice: max(p.price) })).sort(p => desc(p.largestPrice))"
```

## Endpoints

- [swagger](http://localhost:9292/docs)
- [metrics](http://localhost:9291/metrics)
- [Prometheus](http://localhost:9090)
- [Grafana](http://localhost:3000)
- Dashboards
  - [NodeJS Application Dashboard](http://localhost:3000/d/PTSqcpJWk/nodejs-application-dashboard)
  - [High Level Application metrics](http://localhost:3000/d/OnjTYJg7k/high-level-application-metrics)
  - [Node Service Level Metrics Dashboard](http://localhost:3000/d/WBxkVyRnz/node-service-level-metrics-dashboard)
  - [NodeJS Request Flow Dashboard](http://localhost:3000/d/2Er5E1R7k/nodejs-request-flow-dashboard)

## Uninstall

```sh
lambdaorm drop -w ./volume/workspace -e ./volume/workspace/.env
docker-compose -p "lambdaorm-svc-pentest" down --remove-orphans
sudo rm -rf ./volume/postgres-data
```
